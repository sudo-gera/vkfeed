''':'
apt update --force-yes -qqq
apt install python --force-yes -qqq
python3 $0 $@
exit
':'''
open_=open
from os import *
from os.path import *
from subprocess import*
from pathlib import Path
from sys import argv
home=str(Path.home())+'/'
path = str(abspath(dirname(argv[0])))
if path[-1]!='/':
	path+='/'
try:
	mkdir(home+'.vkfeed')
except:
	pass
chdir(home+'.vkfeed')
open_('path','w').write(path)
try:
	run(['apt','download','termux-api','--force-yes','-qqq'])
except:
	print('installation failed. check internet connection. if it does not help, turn on mobile data and wifi hotspot and try again')
termux=listdir('.')
termux=[w for w in termux if w.endswith('.deb')]
termux.sort(key=getmtime)
termux=termux[-1]
try:
	run(['apt','install',abspath(termux),'--force-yes','-qqq'])
except:
	print('installation failed. turn on mobile data and wifi hotspot and try again')
chdir(path)
run(['git','pull','--no-edit','-q'])
try:
	run(['ln','-s',path+'news.py',home+'../usr/bin/vkfeed'])
except:
	pass
print('installation complete. now you can run \x1b[32mvkfeed\x1b[0m command')
